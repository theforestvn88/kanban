<% if params[:next_view_id] %>
    <%= turbo_stream.remove dom_id(@card) %>
    <%= turbo_stream.before params[:next_view_id] do %>
        <% prev_card = @board_configs.card_model.find_by(id: params[:next_view_id].split("_").last) %>
        <%= render "kanban7/cards/card", card: @card, prev: (prev_card&.position || prev_card&.id || 0), board_configs: @board_configs %>
    <% end %>
<% else %>
    <% if @after_card %>
        <%= turbo_stream.remove dom_id(@card) %>
        <%= turbo_stream.after "#{dom_id(@after_card)}" do %>
            <%= render "kanban7/cards/card", card: @card, prev: @after_card.position, board_configs: @board_configs %>
        <% end %>
    <% else %>
        <%= turbo_stream.replace dom_id(@card) do %>
            <%= render "kanban7/cards/card", card: @card, prev: 0, board_configs: @board_configs %>
        <% end %>
    <% end %>
<% end %>